window.onload = function () {

 var sock = new SockJS('http://localhost:3000/markdown');
 sock.onopen = function() {
     console.log('open');
 };
 sock.onmessage = function(e) {
   var data = JSON.parse(e.data);
   var totalLines = data.totalLines;
   var diffLine = data.diffLine;
   var target = document.body.scrollHeight * (diffLine / totalLines);
   var trueTarget = Math.max(1, target - 50);
   console.log(totalLines, diffLine, target, trueTarget);
   document.getElementById('content').innerHTML = data.output
   window.scrollTo(0, trueTarget);
 };
 sock.onclose = function() {
     console.log('close');
 };

}
